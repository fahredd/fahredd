# -*- coding: utf-8 -*-
"""fahredd.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/gist/fahredd/eeaa14d90223df7555062e0f76a06c34/w2-kelompok-1.ipynb
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sympy import *
from scipy.optimize import curve_fit

m=111e-3
g=9.8
x=16e-2
k=(m*g)/x
k

m=232e-3
g=9.8
x=18.6e-2
k2=(m*g)/x
k2

Deltax1 = np.array([10,9.6,9.2,8.6,8])/100#udara1pegas1
time1 = np.array([0.9200,1.8325,2.7250,3.6100,4.4950])

Deltax2 = np.array([10,9.4,8.8,8.4,8])/100#udara1pegas2
time2 = np.array([0.8750,1.7475,2.5875,3.4250,4.2225])

Deltax1_2 = np.array([10,9.6,9,8.2,7.6])/100#udara2pegas1
time1_2 = np.array([1.0325,2.0475,3.0400,4.0200,4.9975])

Deltax2_2 = np.array([10,9.4,9,9.2,8.6])/100#udara2pegas2
time2_2 = np.array([0.9450,1.8900,2.8300,3.6825,4.525])

Deltax3 = np.array([10,8,6.8,6,5.2])/100#air1pegas1
time3 = np.array([0.9075,1.785,2.6675,3.535,4.3775])

Deltax4 = np.array([10,9.6,9.4,9.2,8.6])/100#air1pegas2
time4 = np.array([0.8375,1.6675,2.4968,3.321,4.141])

Deltax3_2 = np.array([10,9.6,9,7.6,7.4])/100#air2pegas1
time3_2 = np.array([1.1325,2.2025,3.2475,4.24,5.205])

Deltax4_2 = np.array([10,9.8,9.6,9.2,8.8])/100#air2pegas2
time4_2 = np.array([0.9375,1.835,2.7,3.5475,4.3675])

m1 = 111e-3
m2 = 232e-3
r = 0.014

df = pd.DataFrame({
    'Waktu (s) udara 1 Pegas 1': time1,
    'Deltax udara 1 Pegas 1': Deltax1,
    'Waktu (s) udara 1 Pegas 2': time2,
    'Deltax udara 1 Pegas 2': Deltax2,
    'Waktu (s) udara 2 Pegas 1': time1_2,
    'Deltax udara 2 Pegas 1': Deltax1_2,
    'Waktu (s) udara 2 Pegas 2': time2_2,
    'Deltax udara 2 pegas 2': Deltax2_2
})
# Menampilkan DataFrame
print(df)

df = pd.DataFrame({
    'Waktu (s) udara 1 Pegas 1': time3,
    'Deltax udara 1 Pegas 1': Deltax3,
    'Waktu (s) udara 1 Pegas 2': time4,
    'Deltax udara 1 Pegas 2': Deltax4,
    'Waktu (s) udara 2 Pegas 1': time3_2,
    'Deltax udara 2 Pegas 1': Deltax3_2,
    'Waktu (s) udara 2 Pegas 2': time4_2,
    'Deltax udara 2 pegas 2': Deltax4_2
})

# Menampilkan DataFrame
print(df)

"""Persamaan gerak dari osilasi teredam ini diberikan oleh :

$\ddot{x}+\frac{b}{m}\dot{x}+\frac{k}{m}x=0$

Dengan solusi x pada kasus underdamped adalah

$x(t)=Ae^{\frac{-b}{2m}t}\cos{Ï‰t}$

Untuk mencari b, plot $A_0$ dan $t$ dengan persamaan :

$A(t)=A_0 e^{\frac{-b}{2m}t}$
"""

def exponential_regression(x, a, b):
    return a * np.exp(b * x)

def draw_graph(time1,time2,DeltaX1,DeltaX2,massa1,massa2,medium):
  popt1, pcov1 = curve_fit(exponential_regression, time1,DeltaX1)
  popt2, pcov2 = curve_fit(exponential_regression, time2,DeltaX2)
  A01=popt1[0]
  B1=popt1[1]
  b1 = -B1*2*massa1
  A02=popt2[0]
  B2=popt2[1]
  b2 = -B2*2*massa2
  plt.plot(time1, exponential_regression(time1, *popt1), 'b-', label=f'Regresi Eksponensial massa 1')
  plt.scatter(time1,DeltaX1,c='b')
  plt.plot(time2, exponential_regression(time2, *popt2), 'r-', label=f'Regresi Eksponensial massa 2')
  plt.scatter(time2,DeltaX2,c='r')
  plt.xlabel('Waktu (s)')
  plt.ylabel('Perubahan Posisi (m)')
  plt.legend()
  # Membuat string persamaan regresi dengan LaTeX
  equation1 = fr'$\mathrm{{massa 1}} : y = {A01:.2f} \cdot e^{{{B1:.2f}x}}$'
  equation2 = fr'$\mathrm{{massa 2}}:y = {A02:.2f} \cdot e^{{{B2:.2f}x}}$'
  # Menampilkan persamaan regresi di legenda dengan font LaTeX
  plt.legend(fontsize='medium')
  plt.text(0,0.05, equation1, color='black', fontsize='medium')
  plt.text(0,0.04, equation2, color='black', fontsize='medium')
  plt.title(f'Regresi Eksponensial variasi {medium}')
  plt.tight_layout()
  plt.grid(True)
  plt.show()
  return A01,A02,b1,b2
A01,A02,b1,b2 = draw_graph(time1,time2,Deltax1,Deltax2,m1,m2,'udara')

A01_2,A02_2,b1_2,b2_2 = draw_graph(time1_2,time2_2,Deltax1_2,Deltax2_2,m1,m2,'udara2')

A03,A04,b3,b4 = draw_graph(time3,time4,Deltax3,Deltax4,m1,m2,'Air')

A03_2,A04_2,b3_2,b4_2 = draw_graph(time3_2,time4_2,Deltax3_2,Deltax4_2,m1,m2,'air2')

"""Kemudian menghitung viskositas $\eta$ dengan persamaan

$\eta = \frac{b}{6{\pi}r}$

Untuk menghitung frekuensi sudut teredam

$\omega=\sqrt{(\frac{k}{m})^2-(\frac{b}{2m})^2}$
"""

def menghitung_eta(b,r):
  pi = np.pi
  eta = b/(6*pi*r)
  return eta
menghitung_eta(b1,r)

def menghitung_frekuensi_sudut(k,m,b):
  omega = ((k/m)**2-(b/(2*m))**2)**(0.5)
  return omega

def menghitung_tabel():
  viskositasudara=[menghitung_eta(b1,r),menghitung_eta(b2,r),menghitung_eta(b1_2,r),menghitung_eta(b2_2,r)]
  viskositasair=[menghitung_eta(b3,r),menghitung_eta(b4,r),menghitung_eta(b3_2,r),menghitung_eta(b4_2,r)]
  omega1udara=[menghitung_frekuensi_sudut(k,m1,b1),menghitung_frekuensi_sudut(k,m1,b2),menghitung_frekuensi_sudut(k2,m1,b1_2), menghitung_frekuensi_sudut(k2,m1,b2_2)]
  omega1air=[menghitung_frekuensi_sudut(k,m1,b3),menghitung_frekuensi_sudut(k,m1,b4),menghitung_frekuensi_sudut(k2,m1,b3_2),menghitung_frekuensi_sudut(k2,m1,b4_2)]
  omega2udara=[menghitung_frekuensi_sudut(k,m2,b1),menghitung_frekuensi_sudut(k,m2,b2),menghitung_frekuensi_sudut(k2,m2,b1_2),menghitung_frekuensi_sudut(k2,m2,b2_2)]
  omega2air=[menghitung_frekuensi_sudut(k,m2,b3),menghitung_frekuensi_sudut(k,m2,b4),menghitung_frekuensi_sudut(k2,m2,b3_2),menghitung_frekuensi_sudut(k2,m2,b4_2)]

  df_udara = pd.DataFrame({
    '': ['Udara 1', 'Udara 2', 'Udara 3', 'Udara 4', 'rata rata udara'],
    'viskositas (Pa.s)': viskositasudara + [np.mean(viskositasudara)],
    'omega 1 udara(rad/s)': omega1udara + [np.mean(omega1udara)],
    'omega 2 udara(rad/s)': omega2udara + [np.mean(omega2udara)],
  })
  df_air = pd.DataFrame({
    '': ['Air 1', 'Air 2', 'Air 3', 'Air 4', 'rata rata air'],
    'viskositas (Pa.s)': viskositasair + [np.mean(viskositasair)],
    'omega 1 air(rad/s)': omega1air + [np.mean(omega1air)],
    'omega 2 air(rad/s)': omega2air + [np.mean(omega2air)],
  })
  tabel_gabung = pd.concat([df_udara, df_air], axis=1)
  return tabel_gabung
Tabela = menghitung_tabel()
print(Tabela)

omega1 = menghitung_frekuensi_sudut(k,m1,b1)
omega2 = menghitung_frekuensi_sudut(k,m2,b2)
omega3 = menghitung_frekuensi_sudut(k,m2,b3)
omega4 = menghitung_frekuensi_sudut(k,m1,b4)
omega1_2 = menghitung_frekuensi_sudut(k2,m1,b1_2)
omega2_2 = menghitung_frekuensi_sudut(k2,m2,b2_2)
omega3_2 = menghitung_frekuensi_sudut(k2,m2,b3_2)
omega4_2 = menghitung_frekuensi_sudut(k2,m1,b4_2)
def draw_graph2(time1,time2,DeltaX1,DeltaX2,m1,m2,omega1,omega2):
  popt1, pcov1 = curve_fit(exponential_regression, time1, DeltaX1)
  popt2, pcov2 = curve_fit(exponential_regression, time2, DeltaX2)
  e = np.e
  times1 = (np.linspace(0,time1[-1],1000))
  times2 = (np.linspace(0,time1[-1],1000))
  A01=popt1[0]
  B1=popt1[1]
  b1 = -B1*2*m1
  A02=popt2[0]
  B2=popt2[1]
  b2 = -B2*2*m2
  plt.plot(times1, exponential_regression(times1, *popt1)*(np.cos(omega1*times1)),'r-', label='osilasi benda 1')
  plt.plot(time1, exponential_regression(time1, *popt1), '--', label='Regresi Eksponensial 1')
  plt.plot(times2, exponential_regression(times2, *popt2)*(np.cos(omega2*times1)),color='black', linestyle='-', label='osilasi benda 2')
  plt.plot(time2, exponential_regression(time2, *popt2), 'g--', label='Regresi Eksponensial 2')
  plt.ylim(-0.15,0.15)
  plt.xlabel('Waktu (s)')
  plt.xlim(1,2.5)
  plt.ylabel('Perubahan Posisi (m)')
  plt.legend()
  plt.title('Perbandingan kurva dari DeltaX i terhadap Waktu')
  plt.grid(True)
  plt.show()
draw_graph2(time1,time2,Deltax1,Deltax2,m1,m2,omega1,omega2)

draw_graph2(time1_2,time2_2,Deltax1_2,Deltax2_2,m1,m2,omega3_2,omega4_2)

draw_graph2(time3,time4,Deltax3,Deltax4,m1,m2,omega3,omega4)

draw_graph2(time3_2,time4_2,Deltax3_2,Deltax4_2,m1,m2,omega3_2,omega4_2)
